@{
    ViewData["Title"] = "Calendar";
}

<div class="container-principal calendar">
    <h1>Consultar historial de tasas</h1>
    <div id="calendar"></div>
    <div class="modal fade" id="modalData" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div id="modalBody" class="modal-body">
                </div>
                <div class="btn-group m-5 mb-2 mt-1">
                    <button type="button" class="m-3 mt-0 mb-0" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let calendarEl = document.getElementById('calendar');
                let today = new Date();
            let calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                locale: 'es',
                selectable: true,
                validRange:{
                    end:today.toISOString()
                },
                buttonText: {
                    today: 'Hoy',
                    month: 'Mes',
                    week: 'Semana',
                    day: 'Día',
                    list: 'Lista'
                },dateClick: async function(info) {
                    let date = info.dateStr;
                    let res = await fetch("calendar/historial",
                    {
                        method:'POST',
                        body: JSON.stringify(date),
                        headers:{
                            "Content-Type":"application/json"
                        }
                    });

                    let modalEl = document.getElementById('modalData');
                    document.getElementById('modalBody').innerHTML = await res.text();
                    let dateModal = new bootstrap.Modal(modalEl);
                    dateModal.show();
                }
            });

            calendar.render();
        });
    </script>
}
